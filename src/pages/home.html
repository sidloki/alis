<template>
  <require from="./home.css"></require>
  <ons-page>
    <ons-toolbar modifier="inline transparent" class="searchbar floating">
      <div class="left">
        <ons-toolbar-button click.delegate="showMenu()">
          <ons-icon icon="ion-navicon, material:md-menu"></ons-icon>
        </ons-toolbar-button>
      </div>
      <div class="center" click.delegate="showSearch()">
        <input type="search" class="search-input" placeholder="HÃ¶ranlage suchen..." value.bind="searchText" />
      </div>
      <div class="right">
        <ons-toolbar-button if.bind="searchText" click.delegate="clearSearch()">
          <ons-icon icon="ion-ios-close-empty, material:md-close"></ons-icon>
        </ons-toolbar-button>
      </div>
    </ons-toolbar>
    <div style="display:flex;flex-direction:column;height:100%;">
      <div ref="_map" style="flex:1;width:100%;"></div>
      <div show.bind="selection" style="position:relative;max-height:60%;height:auto;overflow:overlay;z-index:10000" ref="roomlist">
        <ons-button style="position:fixed;right:0;left:auto;margin-top:-16px;z-index:10000;" modifier="quiet">
          <ons-icon icon="ion-record,material:md-circle" size="2x" style="color:#fff;"></ons-icon>
        </ons-button>
        <ons-button click.trigger="deselect()" style="position:fixed;right:0;left:auto;margin-top:-16px;z-index:10001;" modifier="quiet">
          <ons-icon icon="ion-ios-close,material:md-close-circle" size="2x"></ons-icon>
        </ons-button>
        <ons-list>
          <template if.bind="selection.rooms.length === 1">
            <ons-list-header if.bind="selection.name && selection.name !== getRoomName(selection.rooms[0])">
              <span>${selection.name}</span>
            </ons-list-header>
            <template repeat.for="org of selection.organisations">
              <ons-list-item repeat.for="room of org.rooms" tappable click.trigger="showRoom(room)">
                <span class="list-item__title">
                  <span>${getRoomName(room)}</span>
                </span>
                <span class="list-item__subtitle" if.bind="room.organisation">
                  <span>${room.organisation}</span>
                </span>
              </ons-list-item>
            </template>
          </template>
          <template if.bind="selection.rooms.length > 1">
            <ons-list-header if.bind="selection.name">
              <span>${selection.name}</span>
            </ons-list-header>
              <template repeat.for="org of selection.organisations">
                <ons-list-item repeat.for="room of org.rooms" tappable click.trigger="showRoom(room)">
                  <span class="list-item__title">
                    <span>${getRoomName(room)}</span>
                  </span>
                  <span class="list-item__subtitle" if.bind="room.organisation">
                    <span>${room.organisation}</span>
                  </span>
                </ons-list-item>
              </template>
          </template>
        </ons-list>
      </div>
      <!-- <ons-bottom-toolbar show.bind="!selection" style="position:relative;">
        <div style="line-height:44px;padding:0 16px;" click.trigger="showList()">
            Liste anzeigen
        </div>
      </ons-bottom-toolbar> -->
    </div>
  </ons-page>
</template>
