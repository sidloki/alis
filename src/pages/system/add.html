<template>
  <require from="./add.css"></require>

  <ons-page class="page-text">
    <ons-toolbar>
      <div class="left">
        <ons-back-button></ons-back-button>
      </div>
      <div class="center">
        ${title}
      </div>
      <div class="right">
        <ons-toolbar-button click.delegate="commit()">
          <ons-icon icon="md-mail-send"></ons-icon>
        </ons-toolbar-button>
      </div>
    </ons-toolbar>
    <ons-list modifier="noborder" class="form">
      <ons-list-header style="display:none;"></ons-list-header>
      <ons-list-item modifier="nodivider">
        <div class="left">
          <ons-icon icon="ion-ios-location,material:md-pin" fixed-width="true"></ons-icon>
        </div>
        <div class="center">
          <label for="address" class="input-label">Adresse*</label>
          <ons-input input-id="address" type="text" value.one-way="data.address" modifier="underbar" style="width:100%;"
                     focus.trigger="showPositionPage($event)"></ons-input>
        </div>
        <div class="right"></div>
      </ons-list-item>
      <ons-list-item modifier="nodivider">
        <div class="left">
          <ons-icon icon="ion-camera,material:md-camera" fixed-width="true"></ons-icon>
        </div>
        <div class="center">
          <label class="input-label">Foto</label>
          <ons-button if.bind="imageUrl" click.trigger="deleteImage()" modifier="quiet" style="position:absolute;right:6px;top:7px;">LÃ¶schen</ons-button>
          <div class="image-upload">
            <ons-button if.bind="!imageUrl" click.trigger="uploadImageClick()" modifier="quiet" class="upload-button">
              <ons-icon icon="md-plus"></ons-icon>
            </ons-button>
            <div if.bind="imageUrl" class="upload-preview" css="background-image:url(${imageUrl});" click.trigger="uploadImageClick()">
            </div>
            <input type="file" ref="imageInputEl" show.bind="false" change.trigger="onImageChange()" />
          </div>
        </div>
        <div class="right"></div>
      </ons-list-item>
      <ons-list-item modifier="nodivider">
        <div class="left">
          <ons-icon icon="md-comment-text" fixed-width="true"></ons-icon>
        </div>
        <div class="center">
          <label for="annotations" class="input-label">Bemerkung</label>
          <textarea id="annotations" class="textarea" rows="4" style="width:100%;margin-top:8px;"></textarea>
        </div>
        <div class="right"></div>
      </ons-list-item>
      <ons-list-header>Ihre Kontaktdaten</ons-list-header>
      <ons-list-item modifier="nodivider">
        <div class="left">
          <ons-icon icon="ion-person, material:md-account" fixed-width="true"></ons-icon>
        </div>
        <div class="center">
          <label for="username" class="input-label">Name*</label>
          <ons-input input-id="username" type="text" modifier="underbar" style="width:100%;"></ons-input>
        </div>
        <div class="right"></div>
      </ons-list-item>
      <ons-list-item modifier="nodivider">
        <div class="left">
          <ons-icon icon="ion-email, material:md-email" fixed-width="true"></ons-icon>
        </div>
        <div class="center">
          <label for="useremail" class="input-label">E-Mail*</label>
          <ons-input input-id="useremail" type="email" modifier="underbar" style="width:100%;"></ons-input>
        </div>
        <div class="right"></div>
      </ons-list-item>
    </ons-list>
  </ons-page>
  <ons-page if.bind="positionPageVisible">
    <ons-toolbar>
      <div class="left">
        <ons-back-button></ons-back-button>
      </div>
      <div class="center">
        Adresse
      </div>
      <div class="right">
        <ons-toolbar-button disabled.bind="!positionHasAdress" click.trigger="onAcceptAddressClick()">
          <ons-icon icon="md-check"></ons-icon>
        </ons-toolbar-button>
      </div>
    </ons-toolbar>
    <ons-list style="display:flex;flex-direction:column;height:100%;">
      <ons-list-item modifier="nodivider">
        <div class="center">
          <ons-input input-id="address" type="text" ref="addressInputEl" value.one-way="address" style="width:100%;"
                     input.trigger="onAddressChange($event)" blur.trigger="onAddressBlur()" focus.trigger="onAddressFocus()" placeholder="Suchen oder auf Karte tippen..."></ons-input>
        </div>
        <div class="right"></div>
      </ons-list-item>
      <ons-list-item style="flex:1;padding:0 0 0 0;">
        <div class="center" style="min-height:auto;padding:0 0 0 0">
          <leaflet-map mapclick.trigger="onPositionMapClick($event)" overlays.bind="overlays"></leaflet-map>
        </div>
      </ons-list-item>
    </ons-list>
    <ons-popover ref="addressListEl" direction="down" modifier="material" class="popover-address-list" preshow.trigger="onPreAdressListShow()">
      <ons-list modifier="noborder">
        <ons-list-item modifier="nodivider" tappable repeat.for="item of addressList" click.delegate="onAddressListItemClick(item)">
          <div class="center">
            <div class="list-item__title">${item.street}</div>
            <div class="list-item__subtitle">${item.location}</div>
          </div>
        </ons-list-item>
      </ons-list>
    </ons-popover>
  </ons-page>
</template>
