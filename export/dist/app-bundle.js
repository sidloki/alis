System.register("alis/app.html!node_modules/systemjs-plugin-text/text.js",[],function(a,b){"use strict";var c;return{setters:[],execute:function(){a("__useDefault",c=!0),a("__useDefault",c),a("default",'<template>\n  <ons-splitter>\n    <ons-splitter-side id="menu" side="left" collapse>\n      <ons-page>\n        TODO\n      </ons-page>\n    </ons-splitter-side>\n    <ons-splitter-content>\n      <ons-navigator></ons-navigator>\n    </ons-splitter-content>\n  </ons-splitter>\n</template>\n')}}}),System.register("alis/app.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js","aurelia-framework","./services/db"],function(a,b){"use strict";var c,d,e,f,g,h,i;return{setters:[function(a){c=a.default},function(a){d=a.default},function(a){e=a.inject},function(a){f=a.Database}],execute:function(){a("App",i=(g=e(f))(h=function(){function a(b){c(this,a),this.db=b}return d(a,[{key:"activate",value:function(){return this.db.loadData().catch(function(){})}},{key:"configureRouter",value:function(a,b){a.title="Höranlagen",a.map([{route:["","home"],name:"home",moduleId:"./pages/home",nav:!1},{route:"list",name:"list",moduleId:"./pages/list",nav:!1,options:{animation:"lift"}},{route:"room/:id",name:"room",moduleId:"./pages/room/info",nav:!1},{route:"room/:id/plan",name:"room-plan",moduleId:"./pages/room/plan",nav:!1}])}}]),a}())||h),a("App",i)}}}),System.register("alis/environment.js",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",{debug:!0,testing:!1})}}}),System.register("alis/main.js",["aurelia-binding","aurelia-bootstrapper","aurelia-event-aggregator","aurelia-framework","aurelia-dependency-injection","aurelia-history-browser","aurelia-loader-default","aurelia-logging-console","aurelia-metadata","aurelia-pal-browser","aurelia-path","aurelia-polyfills","aurelia-route-recognizer","aurelia-router","aurelia-templating","aurelia-templating-binding","aurelia-templating-resources","aurelia-templating-router","aurelia-onsenui","whatwg-fetch","./environment"],function(a,b){"use strict";function c(a){a.use.basicConfiguration().history().plugin("aurelia-onsenui").feature("alis/resources"),d.debug&&a.use.developmentLogging(),d.testing&&a.use.plugin("aurelia-testing"),a.start().then(function(){return a.setRoot()})}var d;return a("configure",c),{setters:[function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){d=a.default}],execute:function(){}}}),System.register("alis/pages/home.css!node_modules/systemjs-plugin-text/text.js",[],function(a,b){"use strict";var c;return{setters:[],execute:function(){a("__useDefault",c=!0),a("__useDefault",c),a("default",'.leaflet-system-icon {\n  background-color: #2B2C5A;\n  border-radius: 50%;\n  border: 1.5px solid #ffffff;\n  line-height: 22px;\n  font-size: 14px;\n  color: #ffffff;\n  text-align: center;\n}\n\n.marker-cluster-small {\n  line-height: 22px;\n}\n.marker-cluster-medium {\n  line-height: 26px;\n}\n.marker-cluster-large {\n  line-height: 30px;\n}\n\n.marker-cluster {\n\tbackground-clip: padding-box;\n\tborder-radius: 100%;\n  background-color: rgba(43, 44, 90, 0.75);\n  border: 5px solid rgba(43, 44, 90, 0.25);\n}\n.marker-cluster div {\n\n\ttext-align: center;\n\tborder-radius: 15px;\n\t/*font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;*/\n  color: #fff;\n  line-height: inherit;\n}\n\n.leaflet-container .leaflet-google-mutant .gmnoprint {\n  display: none;\n}\n.leaflet-container .leaflet-google-mutant .gmnoprint.gm-style-cc {\n  display: inherit;\n}\n\n.toolbar.searchbar {\n  padding: 5px 10px 0;\n}\n\n.toolbar.searchbar.floating + .page__background + .page__content {\n    margin-top: -1px;\n    top: 0;\n}\n\n.toolbar.searchbar.toolbar--transparent .center {\n  box-shadow: 0 1px 5px rgba(0,0,0,.3);\n  border-color: transparent;\n}\n\n.toolbar.searchbar .toolbar-button {\n  color: #666;\n  margin: 0;\n  padding-top: 0;\n  padding-bottom: 0;\n}\n.toolbar.searchbar.toolbar--material .toolbar-button--material {\n  color: #666;\n  margin: 0;\n}\n.toolbar.searchbar.toolbar--material .toolbar-button--material .ons-icon,\n.toolbar.searchbar.toolbar--material .ons-icon  {\n  width: 22px;\n  font-size: 22px;\n  text-align: center;\n}\n.toolbar.searchbar .toolbar-button .ons-icon, .toolbar.searchbar .ons-icon {\n  width: 17px;\n  text-align: center;\n}\n\n.toolbar.searchbar .left, .toolbar.searchbar .right {\n  min-width: auto;\n  width: auto;\n}\n.toolbar.searchbar .center {\n  flex: 1;\n  display: flex;\n  height: 34px;\n  line-height: 34px;\n  border-radius: 4px;\n  background-color: #fff;\n  max-width: 100%;\n}\n.toolbar.searchbar.toolbar--material .center {\n  height: 46px;\n  line-height: 46px;\n}\n.toolbar.searchbar .search-input {\n  width: 100%;\n  height: 100%;\n  background-image: none;\n  background-color: transparent;\n  border: none;\n  font-size: 17px;\n  padding: 0 8px;\n  line-height: inherit;\n}\n\n.card {\n  margin: 10px;\n  /*border: 1px solid #ccc;*/\n  border-radius: 4px;\n  background-color: #fff;\n  padding: 10px;\n  box-shadow: 0 1px 5px rgba(0,0,0,.3);\n}\n\n.category-item {\n  width: 33%;\n  text-align:center;\n}\n.category-item .category-label {\n  padding-top:5px;\n  font-size:13px;\n  max-width:100%;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: #666;\n}\n\n.category-item .ons-icon {\n  font-size: 24px;\n}\n.category-item .ons-icon.fa {\n  font-size: 17px;\n}\n.category-item .ons-icon.fa.mki {\n  font-size: 28px;\n  padding-top: 0.1em;\n}\n.category-item .ons-icon.fa.mki.mki-chapel,\n.category-item .ons-icon.fa.mki.mki-building {\n  font-size: 32px;\n}\n')}}}),System.register("alis/pages/home.html!node_modules/systemjs-plugin-text/text.js",[],function(a,b){"use strict";var c;return{setters:[],execute:function(){a("__useDefault",c=!0),a("__useDefault",c),a("default",'<template>\n  <require from="./home.css"></require>\n  <ons-page>\n    <ons-toolbar modifier="" class="searchbar">\n      <div class="left">\n      </div>\n      <div class="center">\n        <ons-toolbar-button click.delegate="showMenu()">\n          <ons-icon icon="ion-navicon, material:md-menu"></ons-icon>\n        </ons-toolbar-button>\n        <div style="flex:1" click.delegate="showSearch()">\n          <input type="search" class="search-input" placeholder="Höranlage suchen..." value.bind="searchText" />\n        </div>\n        <ons-toolbar-button if.bind="searchText" click.delegate="clearSearch()">\n          <ons-icon icon="ion-ios-close-empty, material:md-close"></ons-icon>\n        </ons-toolbar-button>\n      </div>\n      <div class="right">\n      </div>\n    </ons-toolbar>\n    <div style="display:flex;flex-direction:column;height:100%;">\n      <div ref="_map" style="flex:1;width:100%;"></div>\n      <div show.bind="selection" style="position:relative;max-height:60%;height:auto;z-index:10000;display:flex;" ref="roomlist">\n        <ons-button style="position:fixed;right:0;left:auto;margin-top:-16px;z-index:10000;" modifier="quiet">\n          <ons-icon icon="ion-record,material:md-circle" size="2x" style="color:#fff;"></ons-icon>\n        </ons-button>\n        <ons-button click.trigger="deselect()" style="position:fixed;right:0;left:auto;margin-top:-16px;z-index:10001;" modifier="quiet">\n          <ons-icon icon="ion-ios-close,material:md-close-circle" size="2x"></ons-icon>\n        </ons-button>\n        <ons-list style="flex:1;overflow-y:scroll;">\n          <template if.bind="selection.rooms.length === 1">\n            <ons-list-header if.bind="selection.name && selection.name !== getRoomName(selection.rooms[0])">\n              <span>${selection.name}</span>\n            </ons-list-header>\n            <template repeat.for="org of selection.organisations">\n              <ons-list-item repeat.for="room of org.rooms" tappable click.trigger="showRoom(room)" style="margin-bottom:0px;">\n                <span class="list-item__title">\n                  <span>${getRoomName(room)}</span>\n                </span>\n                <span class="list-item__subtitle" if.bind="room.organisation">\n                  <span>${room.organisation}</span>\n                </span>\n              </ons-list-item>\n            </template>\n          </template>\n          <template if.bind="selection.rooms.length > 1">\n            <ons-list-header if.bind="selection.name">\n              <span>${selection.name}</span>\n            </ons-list-header>\n              <template repeat.for="org of selection.organisations">\n                <ons-list-item repeat.for="room of org.rooms" tappable click.trigger="showRoom(room)" style="margin-bottom:0px;">\n                  <span class="list-item__title">\n                    <span>${getRoomName(room)}</span>\n                  </span>\n                  <span class="list-item__subtitle" if.bind="room.organisation">\n                    <span>${room.organisation}</span>\n                  </span>\n                </ons-list-item>\n              </template>\n          </template>\n        </ons-list>\n      </div>\n      \x3c!-- <ons-bottom-toolbar show.bind="!selection" style="position:relative;">\n        <div style="line-height:44px;padding:0 16px;" click.trigger="showList()">\n            Liste anzeigen\n        </div>\n      </ons-bottom-toolbar> --\x3e\n    </div>\n  </ons-page>\n    <ons-modal ref="_search">\n      <ons-page>\n        <ons-toolbar modifier="transparent" class="searchbar">\n          <div class="left">\n          </div>\n          <div class="center">\n            <ons-toolbar-button click.delegate="cancelSearch()">\n              <ons-icon icon="ion-ios-arrow-back, material:md-arrow-left"></ons-icon>\n            </ons-toolbar-button>\n            <form style="flex:1;" submit.delegate="onSearch()">\n              <input ref="_searchinput" type="search" class="search-input" placeholder="Höranlage suchen..." value.bind="currentSearchText" input.trigger="onSearchInput()" />\n            </form>\n            <ons-toolbar-button show.bind="currentSearchText" click.delegate="clearCurrentSearch()">\n              <ons-icon icon="ion-ios-close-empty, material:md-close"></ons-icon>\n            </ons-toolbar-button>\n          </div>\n          <div class="right">\n          </div>\n        </ons-toolbar>\n        <div class="card" if.bind="!currentSearchText">\n          <div style="display:flex;flex-wrap:wrap;align-items:flex-start;">\n            <div class="category-item" repeat.for="category of categories">\n              <div style="padding:10px 5px;" click.delegate="searchCategory(category)">\n                <ons-button style="width:48px;height:48px;border-radius:100%;line-height:48px;padding:0;">\n                  <template if.bind="category.icon.indexOf(\'mki\') === 0">\n                    <ons-icon class="category mki ${category.icon}"></ons-icon>\n                  </template>\n                  <template if.bind="category.icon.indexOf(\'mki\') !== 0">\n                    <ons-icon icon.bind="category.icon" class="category"></ons-icon>\n                  </template>\n                </ons-button>\n                <div class="category-label">${category.typ}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class="card" style="padding:0;" if.bind="currentSearchText">\n          <ons-list>\n            <ons-list-item repeat.for="location of currentResults.locations" tappable modifier="longdivider" click.delegate="onLocationResultClick(location)">\n              <div class="left"></div>\n              <div class="center">\n                <span class="list-item__title">${location.name}</span>\n              </div>\n            </ons-list-item>\n            <template repeat.for="building of currentResults.buildings">\n              <ons-list-item repeat.for="org of building.organisations" tappable modifier="longdivider" click.delegate="onBuildingResultClick(building)">\n                <div class="left"></div>\n                <div class="center">\n                  <span class="list-item__title">${building.name || org.name}</span>\n                  <span class="list-item__subtitle">\n                    <span if.bind="building.name">${org.name}</span>\n                    <br if.bind="building.name"/>\n                    <span>${building.strasse_nr}, ${building.plz} ${building.ort}</span>\n                  </span>\n                </div>\n              </ons-list-item>\n            </template>\n          </ons-list>\n        </div>\n      </ons-page>\n    </ons-modal>\n</template>\n')}}}),System.register("alis/services/search.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js","aurelia-framework","./db"],function(a,b){"use strict";var c,d,e,f,g,h,i;return{setters:[function(a){c=a.default},function(a){d=a.default},function(a){e=a.inject},function(a){f=a.Database}],execute:function(){a("Search",i=(g=e(f))(h=function(){function a(b){c(this,a),this.db=b}return d(a,[{key:"execute",value:function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,d={locations:[],buildings:[]};if(a=a.trim(),a.length<3)return d;a=a.toLowerCase().split(" ").filter(function(a){return""!==a});for(var e=0;e<this.db.data.locations.length;e++){for(var f=this.db.data.locations[e],g=(f.name+" "+f.plz).toLowerCase(),h=0,i=0;i<a.length;i++){var j=a[i];g.indexOf(j)>-1&&h++}if(h===a.length&&d.locations.push(f),3===d.locations.length)break}for(var k=function(e){var f=b.db.data.buildings[e],g=f.name+" "+f.strasse_nr+" "+f.ort+" "+f.plz+" "+f.kanton.kantonkuerzel;f.organisations.forEach(function(a){g=g+" "+a.name}),f.rooms.forEach(function(a){var c=b.db.data.roomtypes.find(function(b){return b.typID===a.typID});g=g+" "+c.typ}),g=g.toLowerCase();for(var h=0,i=0;i<a.length;i++){var j=a[i];g.indexOf(j)>-1&&h++}if(h===a.length&&d.buildings.push(f),d.buildings.length===c)return"break"},l=0;l<this.db.data.buildings.length;l++){if("break"===k(l))break}return d}}]),a}())||h),a("Search",i)}}}),System.register("alis/services/storage.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a.default},function(a){d=a.default}],execute:function(){a("Storage",e=function(){function a(){c(this,a),this.stores={local:localStorage,session:sessionStorage}}return d(a,[{key:"getItem",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"local";return JSON.parse(this.stores[b].getItem(a))}},{key:"setItem",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"local";this.stores[c].setItem(a,JSON.stringify(b))}}]),a}()),a("Storage",e)}}}),System.register("alis/pages/home.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js","onsenui","aurelia-router","aurelia-framework","../services/db","../services/search","../services/storage"],function(a,b){"use strict";function c(a,b,c,d){c&&Object.defineProperty(a,b,{enumerable:c.enumerable,configurable:c.configurable,writable:c.writable,value:c.initializer?c.initializer.call(d):void 0})}function d(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;return{setters:[function(a){e=a.default},function(a){f=a.default},function(a){g=a.default},function(a){h=a.Router},function(a){i=a.inject,j=a.bindable},function(a){k=a.Database},function(a){l=a.Search},function(a){m=a.Storage}],execute:function(){a("Home",s=(n=i(h,k,m,l))((p=function(){function a(b,d,f,g){e(this,a),c(this,"selection",q,this),c(this,"currentResults",r,this),this.router=b,this.db=d,this.storage=f,this.search=g}return f(a,[{key:"attached",value:function(){g.platform.isAndroid()&&this._map.classList.add("map--material"),this.map=L.map(this._map,{attributionControl:!1}),this.basemap=L.gridLayer.googleMutant({type:"roadmap",styles:[{featureType:"poi",elementType:"labels.icon",stylers:[{visibility:"off"}]}]}).addTo(this.map),this.buildingsLayer=L.markerClusterGroup({maxClusterRadius:40,iconCreateFunction:function(a){var b=a.getChildCount(),c=" marker-cluster-",d=22;return b<10?c+="small":b<100?(c+="medium",d=26):(c+="large",d=30),new L.DivIcon({html:"<div>"+b+"</div>",className:"marker-cluster"+c,iconSize:d})}}).addTo(this.map),this.markers=L.featureGroup().addTo(this.map),this.locateControl=L.control.locate({showPopup:!1,locateControl:{}}).addTo(this.map),this.locateControl._start=this.locateControl.start.bind(this.locateControl),this.locateControl._stop=this.locateControl.stop.bind(this.locateControl),this.locateControl._setView=this.locateControl.setView.bind(this.locateControl),this.locateControl.stop=this.onLocateControlStop.bind(this),this.locateControl.start=this.onLocateControlStart.bind(this),this.locateControl.setView=this.onLocateControlSetView.bind(this);var a=this.storage.getItem("mapbounds");a?this.map.fitBounds(a):this.map.setView([46.801111,8.226667],7),this.storage.getItem("geolocation")&&this.locateControl.start(),this.map.on("moveend",this.updateMapView,this),this.markers.on("click",this.onMarkerClick,this),this.buildingsLayer.on("click",this.onBuildingClick,this),this.buildingsLayer.on("dblclick",this.onBuildingDoubleClick,this),this.buildings=this.db.data.buildings,this.categories=this.db.data.roomtypes}},{key:"onBuildingClick",value:function(a){this.selection===a.layer.data&&1===this.selection.rooms.length?this.showRoom(this.selection.rooms[0]):this.selection=a.layer.data}},{key:"onBuildingDoubleClick",value:function(a){this.selection=a.layer.data,1===this.selection.rooms.length&&this.showRoom(this.selection.rooms[0])}},{key:"onMarkerClick",value:function(a){this.selection&&1===this.selection.rooms.length&&this.showRoom(this.selection.rooms[0])}},{key:"deselect",value:function(){this.selection=null}},{key:"selectionChanged",value:function(a,b){var c=this;this.markers.clearLayers(),a?function(){var b=L.marker([a.lat,a.lng]);c.markers.addLayer(b),c.roomlist.scrollTop=0,setTimeout(function(){c.map.invalidateSize({pan:!1}),c.map.getBounds().contains(b.getLatLng())||(c.locateControl._onDrag(),c.map.setView(b.getLatLng(),c.map.getZoom()),b._bringToFront())},50)}():setTimeout(function(){c.map.invalidateSize({pan:!1})},50)}},{key:"updateMapView",value:function(a){var b=a.target.getBounds();this.storage.setItem("mapbounds",[[b.getSouth(),b.getWest()],[b.getNorth(),b.getEast()]])}},{key:"onLocateControlStart",value:function(){this.storage.setItem("geolocation",!0),this.locateControl.isLocatingStart=!0,this.locateControl._start()}},{key:"onLocateControlStop",value:function(){this.storage.setItem("geolocation",!1),this.locateControl._stop()}},{key:"onLocateControlSetView",value:function(){this.locateControl.isLocatingStart?(this.locateControl.isLocatingStart=!1,this.locateControl.options.keepCurrentZoomLevel=!1,this.locateControl.options.locateOptions.maxZoom=this.map.getZoom()<15?15:this.map.getZoom(),this.locateControl._setView(),this.locateControl.options.keepCurrentZoomLevel=!0,this.locateControl.options.locateOptions.maxZoom=1/0):this.locateControl._setView()}},{key:"getRoomName",value:function(a){var b=(a.raum+" "+a.raumnummer).trim();if(b||(b=a.gebaeude),!b){b=this.db.data.roomtypes.find(function(b){return b.typID===a.typID}).typ}return b}},{key:"showMenu",value:function(){document.getElementById("menu").open()}},{key:"showSearch",value:function(){this._search.show(),this._searchinput.focus(),this.isSearching=!0,this.currentSearchText=this.searchText,this.currentResults=this.results}},{key:"cancelSearch",value:function(){this._search.hide(),this.currentSearchText="",this.currentResults={},this.isSearching=!1}},{key:"clearSearch",value:function(){this.searchText=this.currentSearchText="",this.buildings=this.db.data.buildings,this.selection=null}},{key:"showList",value:function(){this.router.navigateToRoute("list")}},{key:"showRoom",value:function(a){this.router.navigateToRoute("room",{id:a.anlageID})}},{key:"searchCategory",value:function(a){this.isFiltered=!0,this._search.hide(),this.searchText=this.currentSearchText=a.typ,this.buildings=this.db.queryBuildingsByRoomType(a),this.results=this.currentResults={buildings:this.buildings,locations:[]},this.selection=null,this.zoomToNearest()}},{key:"zoomToNearest",value:function(){var a=this.map.getCenter(),b=L.GeometryUtil.closestLayer(this.map,this.buildingsLayer.getLayers(),a);if(!this.map.getBounds().contains(b.layer.getLatLng())){var c=L.latLngBounds(b.layer.getLatLng(),a);this.locateControl._onDrag(),this.map.fitBounds(c,{maxZoom:this.map.getZoom(),padding:[40,40]})}}},{key:"clearCurrentSearch",value:function(){this.currentSearchText="",this.currentResults={buildings:[],locations:[]},this._searchinput.focus()}},{key:"onBuildingResultClick",value:function(a){var b=this;this.isFiltered||(this.buildings=this.db.data.buildings),this.searchText=this.currentSearchText,this.results=this.currentResults,this.selection=null,this._search.hide(),this.map.once("moveend",function(){b.selection=a}),this.locateControl._onDrag(),this.map.setView([a.lat,a.lng],17)}},{key:"onLocationResultClick",value:function(a){this.isFiltered||(this.buildings=this.db.data.buildings),this.searchText=this.currentSearchText,this.results=this.currentResults,this.selection=null,this._search.hide(),this.locateControl._onDrag(),this.map.fitBounds(a.bounds)}},{key:"onSearch",value:function(){this.currentResults=this.search.execute(this.currentSearchText,20)}},{key:"onSearchInput",value:function(){this.isFiltered=!1,this.currentResults=this.search.execute(this._searchinput.value,10)}},{key:"buildings",set:function(a){var b=this;this.buildingsLayer.clearLayers(),a.forEach(function(a){var c=void 0;c=1===a.rooms.length?L.divIcon({className:"leaflet-system-icon fa fa-deaf",iconSize:22}):L.divIcon({className:"leaflet-system-icon",iconSize:22,html:a.rooms.length});var d=L.marker([a.lat,a.lng],{icon:c});d.data=a,b.buildingsLayer.addLayer(d)})},get:function(){return this.buildingsLayer.getLayers().map(function(a){return a.data})}}]),a}(),q=d(p.prototype,"selection",[j],{enumerable:!0,initializer:null}),r=d(p.prototype,"currentResults",[j],{enumerable:!0,initializer:null}),o=p))||o),a("Home",s)}}}),System.register("alis/pages/list.html!node_modules/systemjs-plugin-text/text.js",[],function(a,b){"use strict";var c;return{setters:[],execute:function(){a("__useDefault",c=!0),a("__useDefault",c),a("default",'<template>\n  <ons-page>\n    <ons-toolbar>\n      <div class="left">\n        <ons-back-button></ons-back-button>\n      </div>\n      <div class="center">${title}</div>\n    </ons-toolbar>\n\n    Some content ...\n  </ons-page>\n</template>\n')}}}),System.register("alis/pages/list.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","aurelia-framework","aurelia-router"],function(a,b){"use strict";var c,d,e,f,g,h;return{setters:[function(a){c=a.default},function(a){d=a.inject},function(a){e=a.Router}],execute:function(){a("List",h=(f=d(e))(g=function a(b){c(this,a),this.title="Anlagen",this.router=b})||g),a("List",h)}}}),System.register("alis/pages/room/info.html!node_modules/systemjs-plugin-text/text.js",[],function(a,b){"use strict";var c;return{setters:[],execute:function(){a("__useDefault",c=!0),a("__useDefault",c),a("default",'<template>\n  <ons-page>\n    <ons-toolbar>\n      <div class="left">\n        <ons-back-button></ons-back-button>\n      </div>\n      <div class="center">${getRoomName()}</div>\n    </ons-toolbar>\n    <div if.bind="getPhotoUrl()" css="background-image:url(\'${getPhotoUrl()}\');background-repeat:no-repeat;background-size:cover;background-position:center;width:100%;height:35%;">\n    </div>\n    <ons-list>\n      <ons-list-item if.bind="data.strasse_nr || data.plz || data.org" tappable>\n        <span class="left">\n          <ons-icon icon="ion-ios-location,material:md-pin" fixed-width="true"></ons-icon>\n        </span>\n        <span class="center">\n          ${data.gebaeude}<template if.bind="data.organisation && data.gebaeude">, </template>${data.organisation}<br/>\n          ${data.strasse_nr}, ${data.plz} ${data.ort}\n      </ons-list-item>\n      <ons-list-item if.bind="data.webadresse" click.trigger="openWebsite()" tappable modifier="chevron" >\n        <span class="left">\n          <ons-icon icon="md-globe" fixed-width="true"></ons-icon>\n        </span>\n        <span class="center">Website</span>\n      </ons-list-item>\n      <ons-list-item tappable modifier="chevron" if.bind="hasRoomPlan()" click.trigger="showRoomPlan()">\n        <span class="left" style="">\n          <ons-icon icon="ion-map" fixed-width="true"></ons-icon>\n        </span>\n        <span class="center">\n          Raumplan\n        </span>\n      </ons-list-item>\n      <ons-list-header>\n        Höranlage\n      </ons-list-header>\n      <ons-list-item>\n        <span class="left" style="">\n          <img src="${getTechImageUrl()}" alt="" style="width:1.28571429em;"/>\n        </span>\n        <span class="center">\n          ${getTechName()}\n        </span>\n      </ons-list-item>\n      <ons-list-item>\n        <span class="left" style="">\n          <img src="${getRatingImageUrl()}" alt="" style="width:1.28571429em;"/>\n        </span>\n        <span class="center">\n          ${getRatingName()}\n        </span>\n      </ons-list-item>\n      <ons-list-item if.bind="data.bemerkung">\n        ${data.bemerkung}\n      </ons-list-item>\n    </ons-list>\n  </ons-page>\n</template>\n')}}}),System.register("alis/pages/room/info.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js","aurelia-framework","aurelia-router","../../services/db"],function(a,b){"use strict";var c,d,e,f,g,h,i,j;return{setters:[function(a){c=a.default},function(a){d=a.default},function(a){e=a.inject},function(a){f=a.Router},function(a){g=a.Database}],execute:function(){a("Info",j=(h=e(f,g))(i=function(){function a(b,d){c(this,a),this.router=b,this.db=d}return d(a,[{key:"activate",value:function(a){var b=parseInt(a.id);this.data=this.db.data.systems.find(function(a){return a.id===b})}},{key:"getRoomName",value:function(){var a=this,b=(this.data.raum+" "+this.data.raumnummer).trim();if(b||(b=this.data.gebaeude),!b){b=this.db.data.roomtypes.find(function(b){return b.typID===a.data.typID}).typ}return b}},{key:"openWebsite",value:function(){window.open(this.data.webadresse,"_system")}},{key:"hasRoomPlan",value:function(){return"transp.png"!==this.data.plan1_dateiname||"transp.png"!==this.data.plan2_dateiname}},{key:"showRoomPlan",value:function(){this.router.navigateToRoute("room-plan",{id:this.data.id})}},{key:"getPhotoUrl",value:function(){var a=this.data.foto_dateiname;return a&&"transp.png"!==a?"//www.zeta.hoeranlagenverzeichnis.ch/admin/images/image_front/"+a:null}},{key:"getTechImageUrl",value:function(){var a=this;return"resources/symbols/"+this.db.data.technologies.find(function(b){return b.techID===a.data.techID}).technologie+".png"}},{key:"getTechName",value:function(){var a=this;return this.db.data.technologies.find(function(b){return b.techID===a.data.techID}).technologie}},{key:"getRatingImageUrl",value:function(){var a="resources/symbols/";switch(this.data.bewertung){case"1":a+="r32_green.png";break;case"2":a+="r32_yellow.png";break;default:a+="r32_white.png"}return a}},{key:"getRatingName",value:function(){var a="";switch(this.data.bewertung){case"1":a="Geprüfte Höranlage gemäss Norm";break;case"2":a="Geprüfte Höranlage nicht nach Norm";break;default:a="Nicht überprüfte Höranlage"}return a}}]),a}())||i),a("Info",j)}}}),System.register("alis/pages/room/plan.css!node_modules/systemjs-plugin-text/text.js",[],function(a,b){"use strict";var c;return{setters:[],execute:function(){a("__useDefault",c=!0),a("__useDefault",c),a("default","ons-select.no-underbar select.select-input--material {\n  background-image: none;\n  padding: 0;\n}\n")}}}),System.register("alis/pages/room/plan.html!node_modules/systemjs-plugin-text/text.js",[],function(a,b){"use strict";var c;return{setters:[],execute:function(){a("__useDefault",c=!0),a("__useDefault",c),a("default",'<template>\n  <require from="./plan.css"></require>\n  <ons-page>\n    <ons-toolbar>\n      <div class="left">\n        <ons-back-button></ons-back-button>\n      </div>\n      <div class="center">${getRoomName()}</div>\n    </ons-toolbar>\n    <ons-list if.bind="plans.length > 0" style="display:flex;flex-direction:column;height:100%;">\n      <ons-list-item modifier="longdivider" if.bind="plans.length === 1">\n        Raumplan\n      </ons-list-item>\n      <ons-list-item modifier="longdivider" if.bind="plans.length > 1">\n        <ons-select style="width:100%;" value.bind="plan" class="no-underbar">\n          <option repeat.for="plan of plans" value.bind="plan.value">${plan.text}</option>\n        </ons-select>\n      </ons-list-item>\n      <ons-list-item style="flex:1;padding:0 0 0 0;">\n        <div class="center" style="min-height:auto;padding:1px 0 0 0"><div ref="planmap" style="width:100%;height:100%;"></div></div>\n      </ons-list-item>\n    </ons-list>\n    <div if.bind="plans.length === 0" style="padding:0 12px;">\n      <p>\n        Für diesen Raum wurden keine Pläne gefunden.\n      </p>\n    </div>\n  </ons-page>\n</template>\n')}}}),System.register("alis/models/building.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a.default},function(a){d=a.default}],execute:function(){a("Building",e=function(){function a(b){c(this,a),Object.assign(this,b)}return d(a,null,[{key:"tablename",get:function(){return"buildings"}}]),a}()),a("Building",e)}}}),System.register("alis/models/canton.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a.default},function(a){d=a.default}],execute:function(){a("Canton",e=function(){function a(b){c(this,a),Object.assign(this,b)}return d(a,[{key:"id",get:function(){return this.kantonID}}],[{key:"tablename",get:function(){return"cantons"}}]),a}()),a("Canton",e)}}}),System.register("alis/models/location.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a.default},function(a){d=a.default}],execute:function(){a("Location",e=function(){function a(b){c(this,a),Object.assign(this,b)}return d(a,null,[{key:"tablename",get:function(){return"locations"}}]),a}()),a("Location",e)}}}),System.register("alis/models/organisation.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a.default},function(a){d=a.default}],execute:function(){a("Organisation",e=function(){function a(b){c(this,a),Object.assign(this,b)}return d(a,null,[{key:"tablename",get:function(){return"organisations"}}]),a}()),a("Organisation",e)}}}),System.register("alis/models/room-type.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js"],function(a,b){"use strict";var c,d,e,f;return{setters:[function(a){c=a.default},function(a){d=a.default}],execute:function(){e={1:"mki-building",2:"ion-university, material:md-graduation-cap",3:"mki-chapel",4:"mki-museum",5:"mki-court_house",6:"ion-ios-email, material:md-email",7:"ion-ios-people",8:"ion-ios-film, material:md-movie-alt",9:"mki-theatre"},a("RoomType",f=function(){function a(b){c(this,a),Object.assign(this,b)}return d(a,[{key:"id",get:function(){return this.typID}},{key:"icon",get:function(){return e[this.id]}}],[{key:"tablename",get:function(){return"roomtypes"}}]),a}()),a("RoomType",f)}}}),System.register("alis/models/system.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a.default},function(a){d=a.default}],execute:function(){a("System",e=function(){function a(b){c(this,a),Object.assign(this,b)}return d(a,[{key:"id",get:function(){return this.anlageID}}],[{key:"tablename",get:function(){return"systems"}}]),a}()),a("System",e)}}}),System.register("alis/models/technology.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a.default},function(a){d=a.default}],execute:function(){a("Technology",e=function(){function a(b){c(this,a),Object.assign(this,b)}return d(a,[{key:"id",get:function(){return this.techID}}],[{key:"tablename",get:function(){return"technologies"}}]),a}()),a("Technology",e)}}}),System.register("alis/services/db.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js","aurelia-fetch-client","../models/building","../models/canton","../models/location","../models/organisation","../models/room-type","../models/system","../models/technology"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m;return{setters:[function(a){c=a.default},function(a){d=a.default},function(a){e=a.HttpClient},function(a){f=a.Building},function(a){g=a.Canton},function(a){h=a.Location},function(a){i=a.Organisation},function(a){j=a.RoomType},function(a){k=a.System},function(a){l=a.Technology}],execute:function(){a("Database",m=function(){function a(){c(this,a),this.resetData(),this.http=new e,this.http.configure(function(a){a.useStandardConfiguration().withBaseUrl("//www.zeta.hoeranlagenverzeichnis.ch/query.php?").withDefaults({headers:{}}).withInterceptor({request:function(a){return console.log("Requesting "+a.method+" "+a.url),a},response:function(a){return console.log("Received "+a.status+" "+a.url),a}})})}return d(a,[{key:"resetData",value:function(){this.data={}}},{key:"loadData",value:function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=[g,j,k,l];return!0===b||0===Object.keys(this.data).length?(this.resetData(),Promise.all(c.map(function(b){var c=b.tablename;return a.http.fetch("table="+c).then(function(a){return a.json()}).then(function(d){a.data[c]=d.results.map(function(a){return new b(a)})}).catch(function(b){console.error(b),a.data[c]=[]})})).then(function(){return a.processData(),a.data})):Promise.resolve(this.data)}},{key:"processData",value:function(){var a=this.data[k.tablename],b=this.data[g.tablename],c={},d={},e={};this.data[f.tablename]=[],this.data[h.tablename]=[],this.data[i.tablename]=[],a.forEach(function(a){a.gebaeudeID=a.plz+"-"+a.strasse_nr+"-"+a.gebaeude,a.organisationID=""+a.organisation,a.locationID=a.ort.trim();var e=c[a.gebaeudeID],g=d[a.locationID];e||(e=new f({id:a.gebaeudeID,name:a.gebaeude,lat:a.lat,lng:a.lng,strasse_nr:a.strasse_nr,plz:a.plz,ort:a.ort,kanton:b.find(function(b){return b.kantonID===a.kantonID}),kantonID:a.kantonID,rooms:[],organisations:[]}),c[a.gebaeudeID]=e),g||(g=new h({id:a.locationID,name:a.locationID,plzs:[],bounds:L.latLngBounds()}),d[a.locationID]=g);var j=e.organisations.find(function(b){return b.id===a.organisationID});j||(j=new i({id:a.organisationID,name:a.organisation,rooms:[]}),e.organisations.push(j)),e.rooms.push(a),j.rooms.push(a),g.bounds.extend(L.latLng(a.lat,a.lng)),-1===g.plzs.indexOf(a.plz)&&g.plzs.push(a.plz)}),this.data[f.tablename]=Object.keys(c).map(function(a){return c[a]}),this.data[h.tablename]=Object.keys(d).map(function(a){return d[a]}),this.data[i.tablename]=Object.keys(e).map(function(a){return e[a]})}},{key:"queryBuildingsByRoomType",value:function(a){return this.data.buildings.reduce(function(b,c){var d=c.rooms.filter(function(b){return b.typID===a.typID});return d.length>0&&function(){var e=new f(c);e.rooms=d,e.organisations=[],c.organisations.forEach(function(b){var c=b.rooms.filter(function(b){return b.typID===a.typID});if(c.length>0){var d=new i(b);d.rooms=c,e.organisations.push(d)}}),b.push(e)}(),b},[])}}]),a}()),a("Database",m)}}}),System.register("alis/pages/room/plan.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js","aurelia-framework","../../services/db"],function(a,b){"use strict";function c(a,b,c,d){c&&Object.defineProperty(a,b,{enumerable:c.enumerable,configurable:c.configurable,writable:c.writable,value:c.initializer?c.initializer.call(d):void 0})}function d(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}var e,f,g,h,i,j,k,l,m,n;return{setters:[function(a){e=a.default},function(a){f=a.default},function(a){g=a.inject,h=a.bindable},function(a){i=a.Database}],execute:function(){a("Plan",n=(j=g(i))((l=function(){function a(b,d){e(this,a),c(this,"plan",m,this),this.db=b}return f(a,[{key:"activate",value:function(a){var b=this,c=[],d=parseInt(a.id);return this.data=this.db.data.systems.find(function(a){return a.id===d}),this.plans=[],"transp.png"!==this.data.plan1_dateiname&&function(){var a={value:b.data.plan1_dateiname,text:"transp.png"!==b.data.plan2_dateiname?"Raumplan "+(Object.keys(b.plans).length+1):"Raumplan",url:"//www.zeta.hoeranlagenverzeichnis.ch/admin/images/image_room1/"+b.data.plan1_dateiname};c.push(new Promise(function(b,c){var d=new Image;d.onload=function(){var c=256/d.width;a.layer=L.imageOverlay(a.url,[[0,0],[d.height*c,d.width*c]]),b()},d.src=a.url})),b.plans.push(a)}(),"transp.png"!==this.data.plan2_dateiname&&function(){var a={value:b.data.plan2_dateiname,text:"transp.png"!==b.data.plan1_dateiname?"Raumplan "+(Object.keys(b.plans).length+1):"Raumplan",url:"//www.zeta.hoeranlagenverzeichnis.ch/admin/images/image_room2/"+b.data.plan2_dateiname};c.push(new Promise(function(b,c){var d=new Image;d.onload=function(){var c=256/d.width;a.layer=L.imageOverlay(a.url,[[0,0],[d.height*c,d.width*c]]),b()},d.src=a.url})),b.plans.push(a)}(),Promise.all(c)}},{key:"attached",value:function(){this.plans.length>0&&(this.map=L.map(this.planmap,{crs:L.CRS.Simple,attributionControl:!1,maxZoom:4}),this.plan=this.plans[0].value)}},{key:"getRoomName",value:function(){var a=this,b=(this.data.raum+" "+this.data.raumnummer).trim();if(b||(b=this.data.gebaeude),!b){b=this.db.data.roomtypes.find(function(b){return b.typID===a.data.typID}).typ}return b}},{key:"planChanged",value:function(a,b){if(b){var c=this.getPlan(b);this.map.removeLayer(c.layer)}if(a){var d=this.getPlan(a);this.map.addLayer(d.layer),this.map.fitBounds(d.layer.getBounds()),this.map.setMaxBounds(d.layer.getBounds())}}},{key:"getPlan",value:function(a){return this.plans.find(function(b){return b.value===a})}}]),a}(),m=d(l.prototype,"plan",[h],{enumerable:!0,initializer:null}),k=l))||k),a("Plan",n)}}}),System.register("alis/resources/index.js",[],function(a,b){"use strict";function c(a){}return a("configure",c),{setters:[],execute:function(){}}});